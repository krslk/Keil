C51 COMPILER V9.01   MAIN                                                                  10/09/2024 00:32:25 PAGE 1   


C51 COMPILER V9.01, COMPILATION OF MODULE MAIN
OBJECT MODULE PLACED IN .\object\main.obj
COMPILER INVOKED BY: C:\Keil_v5\C51\BIN\C51.EXE user\main.c BROWSE DEBUG OBJECTEXTEND PRINT(.\listing\main.lst) OBJECT(.
                    -\object\main.obj)

line level    source

   1          #include <reg52.h>
   2          
   3          typedef unsigned char uchar_8;
   4          typedef unsigned int uint_16;
   5          
   6          #ifndef LED_CONTROLLER
   7          
   8          sbit led_green_ns = P1 ^ 4;
   9          sbit led_yellow_ns = P1 ^ 5;
  10          sbit led_red_ns = P1 ^ 6;
  11          sbit led_green_we = P2 ^ 6;
  12          sbit led_yellow_we = P2 ^ 5;
  13          sbit led_red_we = P2 ^ 4;
  14          sbit led_test = P0 ^ 1;
  15          
  16          #endif
  17          
  18          #ifndef LED_SCREEN
  19          
  20          #define LED_SCREEN P0
  21          uint_16 num_code[] = {0x3f, 0x06, 0x5b, 0x4f, 0x66, 0x6d, 0x7d, 0x07, 0x7f, 0x6f};
  22          sbit cn_we_dec = P2 ^ 0; // 东西方向数字十位
  23          sbit cn_we_one = P2 ^ 1; // 东西方向数字个位
  24          sbit cn_ns_dec = P2 ^ 2; // 南北方向数字十位
  25          sbit cn_ns_one = P2 ^ 3; // 南北方向数字个位
  26          #endif
  27          
  28          uint_16 sec_ns = 25;
  29          uint_16 sec_we = 20;
  30          
  31          // 函数声明
  32          void delay_us(uint_16 us);
  33          void time0_init(void);
  34          void display(void);
  35          
  36          void main()
  37          {
  38   1          time0_init();
  39   1          while (1)
  40   1          {
  41   2              display();
  42   2          }
  43   1      }
  44          
  45          void delay_us(uint_16 us)
  46          {
  47   1          while (us--)
  48   1              ;
  49   1      }
  50          
  51          void time0_init(void)
  52          {
  53   1          TMOD |= 0X01; // 选择为定时器 0 模式，工作方式 1
  54   1          TH0 = 0XFC;   // 给定时器赋初值，定时 1ms
C51 COMPILER V9.01   MAIN                                                                  10/09/2024 00:32:25 PAGE 2   

  55   1          TL0 = 0X18;
  56   1          ET0 = 1; // 打开定时器 0 中断允许
  57   1          EA = 1;  // 打开总中断
  58   1          TR0 = 1; // 打开定时器
  59   1      }
  60          
  61          void time0() interrupt 1
  62          {
  63   1          static uint_16 count_ms = 0;
  64   1          TH0 = 0XFC;
  65   1          TL0 = 0X18;
  66   1          count_ms++;
  67   1          if (count_ms == 1000)
  68   1          {
  69   2              count_ms = 0;
  70   2              sec_we--;
  71   2              sec_ns--;
  72   2          }
  73   1      }
  74          
  75          void display(void)
  76          {
  77   1          cn_we_dec = 1;
  78   1          cn_we_one = 0;
  79   1          cn_ns_dec = 0;
  80   1          cn_ns_one = 0;
  81   1          LED_SCREEN = ~num_code[sec_we / 10];
  82   1          delay_us(50);
  83   1          LED_SCREEN = 0xff;
  84   1          cn_we_dec = 0;
  85   1          cn_we_one = 1;
  86   1          cn_ns_dec = 0;
  87   1          cn_ns_one = 0;
  88   1          LED_SCREEN = ~num_code[sec_we % 10];
  89   1          delay_us(50);
  90   1          LED_SCREEN = 0xff;
  91   1          cn_we_dec = 0;
  92   1          cn_we_one = 0;
  93   1          cn_ns_dec = 1;
  94   1          cn_ns_one = 0;
  95   1          LED_SCREEN = ~num_code[sec_ns / 10];
  96   1          delay_us(50);
  97   1          LED_SCREEN = 0xff;
  98   1          cn_we_dec = 0;
  99   1          cn_we_one = 0;
 100   1          cn_ns_dec = 0;
 101   1          cn_ns_one = 1;
 102   1          LED_SCREEN = ~num_code[sec_ns % 10];
 103   1          delay_us(50);
 104   1          LED_SCREEN = 0xff;
 105   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    199    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =     26    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.

C51 COMPILER V9.01   MAIN                                                                  10/09/2024 00:32:25 PAGE 3   


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
